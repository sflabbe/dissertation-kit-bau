% -----------------------------------------------------------------------------
% Deckblatt / Title page (KIT Bau - dissertation template) - A4 VERSION
% Precisely matched to KIT Bau example layout
%
% FIXED-HEIGHT TITLE BLOCK:
% This version uses a fixed-height vbox for the title so that 1-line and 3-line
% titles produce identical vertical alignment for all content below.
%
% Required macros (define in main file):
%   \headtitle       - Thesis title (allows manual line breaks with \\)
%   \gradintro       - Intro text before degree (e.g., "Zur Erlangung des akademischen Grades")
%   \doktorgrad      - Exact string: DOKTOR-INGENIEURS or DOKTOR-INGENIEURIN
%   \facultyname     - Faculty name ONLY (e.g., "Bauingenieur-, Geo- und Umweltwissenschaften")
%   \institutname    - Institute name WITHOUT "des" (e.g., "Karlsruher Instituts für Technologie (KIT)")
%   \submissiontype  - "genehmigte" (approved) or "eingereichte" (submitted)
%   \authorname      - Author name only (e.g., "Max Mustermann" or "[Vorname Nachname]")
%   \authordegree    - Academic suffix (e.g., "M.Sc.", "Dipl.-Ing.")
%   \birthline       - Birth info: "geb. in [Stadt]" or "aus [Geburtsort, Land]"
%   \defensedate     - Defense date (optional, hide if empty)
%   \referee         - Main referee (optional, hide if empty)
%   \coreferee       - Co-referee (optional, hide if empty)
%
% Layout uses absolute font sizes and fixed-width parboxes for precise visual matching
% CRITICAL: Uses \begingroup to force single spacing and zero parskip (overrides global settings)
% -----------------------------------------------------------------------------

\begin{titlepage}
\thispagestyle{empty}
%
\begingroup
\centering

% Force Times/Nimbus metrics if available (matches legacy pdfLaTeX line breaks)
\IfFontExistsTF{Nimbus Roman}{\newfontfamily\DeckblattRoman{Nimbus Roman}\DeckblattRoman}{}

\setlength{\parindent}{0pt}
\setlength{\parskip}{0pt}
\ifdefined\singlespacing\singlespacing\fi

% fallbacks (so template compiles even if main file forgot macros)
\providecommand{\gradintro}{Zur Erlangung des akademischen Grades}
\providecommand{\doktorgrad}{DOKTOR-INGENIEURS}
\providecommand{\facultyname}{Bauingenieur-, Geo- und Umweltwissenschaften}
\providecommand{\institutname}{Karlsruher Instituts für Technologie (KIT)}
\providecommand{\submissiontype}{genehmigte}
\providecommand{\authorname}{[Vorname Nachname]}
\providecommand{\authordegree}{M.Sc.}
\providecommand{\birthline}{aus [Geburtsort, Land]}
\providecommand{\defensedate}{}
\providecommand{\referee}{}
\providecommand{\coreferee}{}

\newlength{\TitleBlockHeight}
\setlength{\TitleBlockHeight}{2.4cm} % TUNE: 2.4–2.9cm until it matches example

\vspace*{1.95cm} % TUNE: 1.9–2.4cm - title sits higher

% fixed-height title block - title positioned at top (no vertical centering)
\vbox to \TitleBlockHeight{%
  {\fontsize{16}{19}\selectfont\bfseries
   \parbox{0.73\textwidth}{\centering \headtitle\par}\par}% narrower width for better line breaks
  \vfill
}

\vspace{1.7cm} % TUNE: 1.4–1.8cm - adjusted for higher title

{\fontsize{9.5}{11.5}\selectfont \gradintro\space einer\par}
\vspace{0.65cm}
{\fontsize{12}{14}\selectfont\bfseries \doktorgrad\par}

\vspace{1.05cm}

{\fontsize{9.5}{11.5}\selectfont
\parbox{0.78\textwidth}{\centering
von der Fakultät für\par
\facultyname\par
des \institutname\par
}\par}

\vspace{1.0cm}

{\fontsize{9.5}{11.5}\selectfont \submissiontype\par}
\vspace{0.55cm}
{\fontsize{12}{14}\selectfont\bfseries DISSERTATION\par}

\vspace{0.8cm}

{\fontsize{9.5}{11.5}\selectfont von\par}
\vspace{0.4cm}
{\fontsize{12}{14}\selectfont \authorname\space\authordegree\par}
\vspace{0.2cm}
{\fontsize{9.5}{11.5}\selectfont \birthline\par}

\vfill

% Bottom block: only show if at least one field is non-empty
% Use tabular* with fixed column widths so right column doesn't hug page edge
% Check if ANY of the three fields is non-empty
\newif\ifshowbottom
\showbottomfalse
\ifx\defensedate\empty\else\showbottomtrue\fi
\ifx\referee\empty\else\showbottomtrue\fi
\ifx\coreferee\empty\else\showbottomtrue\fi

\ifshowbottom
{\fontsize{9.5}{11.5}\selectfont
\noindent
\begin{tabular}{@{}p{0.58\textwidth}@{}l@{}}
\ifx\defensedate\empty\else Tag der mündlichen Prüfung: & \defensedate\\\fi
\ifx\referee\empty\else Hauptreferent: & \referee\\\fi
\ifx\coreferee\empty\else Korreferent: & \coreferee\\\fi
\end{tabular}\par}
\fi

\vspace*{0.0cm} % IMPORTANT: keep near zero so bottom block sits low
\endgroup
%
% Restore document geometry after titlepage
\restoregeometry
%
\end{titlepage}
